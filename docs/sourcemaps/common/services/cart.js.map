{"version":3,"sources":["common/services/cart.js"],"names":["Cart","items","callbacks","item","some","i","name","push","calcPrice","fireCallbacks","arrayItem","_remove","index","indexOf","splice","dir","count","totalPrice","price","callback","func","data","forEach","module","service"],"mappings":"AAAA;;AAEA,OAAO,eAAe,SAAS,cAAc;EAC3C,OAAO;;;AAGT,IAAI,eAAe,YAAY,EAAE,SAAS,iBAAiB,QAAQ,OAAO,EAAE,KAAK,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,EAAE,IAAI,aAAa,MAAM,IAAI,WAAW,aAAa,WAAW,cAAc,OAAO,WAAW,eAAe,MAAM,IAAI,WAAW,YAAY,WAAW,WAAW,MAAM,OAAO,eAAe,QAAQ,WAAW,KAAK,iBAAiB,OAAO,UAAU,aAAa,YAAY,aAAa,EAAE,IAAI,YAAY,iBAAiB,YAAY,WAAW,aAAa,IAAI,aAAa,iBAAiB,aAAa,cAAc,OAAO;;AANhiB,IAAA,WAAA,QAAA;;AAUA,IAAI,YAAY,uBAAuB;;AATvC,IAAA,QAAA,QAAA;;AAaA,IAAI,SAAS,uBAAuB;;AAEpC,SAAS,uBAAuB,KAAK,EAAE,OAAO,OAAO,IAAI,aAAa,MAAM,EAAE,SAAS;;AAEvF,SAAS,gBAAgB,UAAU,aAAa,EAAE,IAAI,EAAE,oBAAoB,cAAc,EAAE,MAAM,IAAI,UAAU;;AAEhH,IAjBMA,OAiBK,YAAY;;EAfrB,SAAA,OAAa;IAAA,gBAAA,MAAA;;IACX,KAAKC,QAAQ;IACb,KAAKC,YAAY;;;EAsBnB,aAAa,MAAM,CAAC;IAClB,KAAK;IACL,OAAO,SAAS,IArBbC,MAAM;MACT,IAAG,CAAC,KAAKF,MAAMG,KAAK,UAAA,GAAA;QAAA,OAAKC,EAAEC,SAASH,KAAKG;UAAO;QAC9C,KAAKL,MAAMM,KAAKJ;;;MAGlB,KAAKK,UAAUL;MACf,KAAKM,cAAc,KAAKR;;KAyBvB;IACD,KAAK;IACL,OAAO,SAAS,OAxBVE,MAAM;MACZ,IAAMO,YAAY,CAAA,GAAA,OAAA,SAAK,KAAKT,OAAO,UAAA,GAAA;QAAA,OAAKI,EAAEC,SAASH,KAAKG;;MACxD,KAAKE,UAAUE,WAAY,CAAC;;MAE5B,IAAGA,UAAUC,SAAS;QACpB,IAAMC,QAAQ,KAAKX,MAAMY,QAAQH;QACjC,KAAKT,MAAMa,OAAOF,OAAO;;;MAG3B,KAAKH,cAAc,KAAKR;;KA4BvB;IACD,KAAK;IACL,OAAO,SAAS,UA3BPE,MAAe;MAAA,IAATY,MAAS,UAAA,SAAA,KAAA,UAAA,OAAA,YAAA,UAAA,KAAH;;MACrBZ,KAAKa,QAAQb,KAAKa,SAAS,OAAOb,KAAKa,QAAQD,MAAM;MACrDZ,KAAKc,aAAad,KAAKe,QAAQf,KAAKa;;KA+BnC;IACD,KAAK;IACL,OAAO,SAAS,QA9BT;MACP,KAAKf,QAAQ;MACb,KAAKQ,cAAc,KAAKR;;KAgCvB;IACD,KAAK;IACL,OAAO,SAAS,OA/BVkB,UAAU;MAChB,KAAKjB,UAAUK,KAAK;QAClBa,MAAMD;;;KAkCP;IACD,KAAK;IACL,OAAO,SAAS,cAhCHE,MAAM;MACnB,KAAKnB,UAAUoB,QAAQ,UAAA,UAAA;QAAA,OAAYH,SAASC,KAAKC;;;;;EAsCnD,OAAO;;;AApCR;;AAyCD,QAAQ,UAvCO,UAAA,QACZE,OAAO,QAAQ,IACfC,QAAQ,QAAQxB,MAqC0D","file":"../../../common/services/cart.js","sourcesContent":["import angular from 'angular';\nimport find from 'lodash/find';\n\nclass Cart {\n  /*@ngInject*/\n  constructor(){\n    this.items = [];\n    this.callbacks = [];\n  }\n\n  add (item) {\n    if(!this.items.some(i => i.name === item.name)) {\n      this.items.push(item);\n    }\n\n    this.calcPrice(item);\n    this.fireCallbacks(this.items);\n  }\n\n  remove (item) {\n    const arrayItem = find(this.items, i => i.name === item.name);\n    this.calcPrice(arrayItem , -1);\n\n    if(arrayItem._remove) {\n      const index = this.items.indexOf(arrayItem);\n      this.items.splice(index, 1);\n    }\n\n    this.fireCallbacks(this.items);\n  }\n\n  calcPrice (item, dir = 1) {\n    item.count = item.count != null ? item.count + dir : 1;\n    item.totalPrice = item.price * item.count;\n  }\n\n  clear () {\n    this.items = [];\n    this.fireCallbacks(this.items);\n  }\n\n  listen (callback) {\n    this.callbacks.push({\n      func: callback\n    })\n  }\n\n  fireCallbacks (data) {\n    this.callbacks.forEach(callback => callback.func(data))\n  }\n};\n\nexport default angular\n  .module('cart', [])\n  .service('Cart', Cart);\n"],"sourceRoot":"/src"}